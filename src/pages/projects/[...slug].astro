---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection, getEntry } from 'astro:content';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((p) => ({ params: { slug: p.slug } }));
}

const { slug } = Astro.params;
const entry = await getEntry('projects', slug!);
const data = entry?.data;
---

<BaseLayout
  title={`${data?.title ?? 'Proyecto'} — Martin Ruiz`}
  description={data?.teaser ?? data?.title ?? 'Proyecto'}
>
  <article class="prose">
    <h1>{data?.title}</h1>
    {
      data?.year && (
        <p>
          <strong>Año:</strong> {data.year}
        </p>
      )
    }
    <slot />
    <div class="mt-6 flex gap-3">
      {
        data?.repo && (
          <a class="btn" href={data.repo}>
            Repositorio
          </a>
        )
      }
      {
        data?.demo && (
          <a class="btn-outline" href={data.demo}>
            Demo
          </a>
        )
      }
    </div>
  </article>
</BaseLayout>
